!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){function t(t,n,i){void 0===i&&(i={});var r=new CustomEvent(n,{bubbles:!0,detail:i});t.dispatchEvent(r)}function n(){function t(){}function n(){return this.t=function(t){t+=String.fromCharCode(128);for(var n=Math.ceil((t.length/4+2)/16),i=new Array(n),r=0;r<n;r++){i[r]=new Array(16);for(var e=0;e<16;e++)i[r][e]=t.charCodeAt(64*r+4*e)<<24|t.charCodeAt(64*r+4*e+1)<<16|t.charCodeAt(64*r+4*e+2)<<8|t.charCodeAt(64*r+4*e+3)}return i[n-1][14]=8*(t.length-1)/Math.pow(2,32),i[n-1][14]=Math.floor(i[n-1][14]),i[n-1][15]=8*(t.length-1)&4294967295,{M:i,N:n}},this.i=function(t,n,i){for(var r,e,o,a,u,c,f,s,h=this,v=t.M,d=t.N,m=new Array(64),w=0;w<d;w++){for(var l=0;l<16;l++)m[l]=v[w][l];for(l=16;l<64;l++)m[l]=this.o(m[l-2])+m[l-7]+this.u(m[l-15])+m[l-16]&4294967295;for(r=n[0],e=n[1],o=n[2],a=n[3],u=n[4],c=n[5],f=n[6],s=n[7],l=0;l<64;l++){var p=s+this.s(u)+this.h(u,c,f)+i[l]+m[l],g=this.v(r)+this.m(r,e,o);s=f,f=c,c=u,u=a+p&4294967295,a=o,o=e,e=r,r=p+g&4294967295}n[0]=n[0]+r&4294967295,n[1]=n[1]+e&4294967295,n[2]=n[2]+o&4294967295,n[3]=n[3]+a&4294967295,n[4]=n[4]+u&4294967295,n[5]=n[5]+c&4294967295,n[6]=n[6]+f&4294967295,n[7]=n[7]+s&4294967295}return n.map(function(t){return h.l(t)})},this.hash=function(t){var n=this.t(t);return this.i(n,this.H,this.K).join("")},this}t.prototype={K:[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],H:[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],l:function(t){for(var n="",i=7;i>=0;i--)n+=(t>>>4*i&15).toString(16);return n},p:function(t,n){return n>>>t|n<<32-t},v:function(t){return this.p(2,t)^this.p(13,t)^this.p(22,t)},s:function(t){return this.p(6,t)^this.p(11,t)^this.p(25,t)},u:function(t){return this.p(7,t)^this.p(18,t)^t>>>3},o:function(t){return this.p(17,t)^this.p(19,t)^t>>>10},h:function(t,n,i){return t&n^~t&i},m:function(t,n,i){return t&n^t&i^n&i}},n.prototype=Object.assign({},t.prototype);var i=new n,r=function(t){for(var n=2;n<t;n++)if(t%n==0)return!1;return t>1},e=function(t,n){var e=t.question,o=t.time;void 0===n&&(n=1);for(var a={question:e,time:o,nonce:++n},u=i.hash(JSON.stringify(a));"0000"!==u.substr(0,4)||!r(n);)a={question:e,time:o,nonce:++n},u=i.hash(JSON.stringify(a));return{verify_array:a,nonce:n,hash:u}};self.addEventListener("message",function(t){var n=t.data;self.postMessage({action:"message",message:"Checking if you're a bot before enabling submit button..."});var i=n.difficulty,r=n.time;(function(){try{var t=new FormData;return t.append("endpoint","question"),Promise.resolve(fetch("https://wehatecaptchas.com/api.php",{method:"POST",body:t})).then(function(t){return Promise.resolve(t.json()).then(function(t){return t.data.question})})}catch(t){return Promise.reject(t)}})().then(function(t){for(var n,o=[],a=null!=(n=a)?n:1,u=0;u<i;u++){var c=e({question:t,time:r},a);a=c.nonce,o.push(c.verify_array);var f=Math.floor((u+1)/i*100);self.postMessage({action:"message",message:"Still checking... "+f+"% done"})}self.postMessage({action:"captchaSuccess",verification:o}),o=[],a=1})},!1)}!function(){window.whcWorkers=[];var i=window.whcConfig||{},r=Object.assign({button:'[type="submit"]',form:".whc-form",difficulty:3,finished:"Submit",events:!0},i),e=document.querySelectorAll(r.form),o=function(i,e){var o,a,u={};u.time=Math.floor(Date.now()/1e3),u.form=i,u.ID=i.getAttribute("id")||"Form "+e,u.button=i.querySelector(r.button),u.difficulty=(o=u.button.getAttribute("data-difficulty"),a=parseInt(o),!isNaN(a)&&a==a&&a||r.difficulty),u.worker=function(){try{var t=new Blob(["("+n.toString()+")();"],{type:"application/javascript"}),i=URL.createObjectURL(t),r=new Worker(i);return window.whcWorkers.push(r),r}catch(t){throw new Error("Uknown Error: "+t)}}(),window.addEventListener("load",function(){u.worker.postMessage({difficulty:u.difficulty,time:u.time})},{once:!0,capture:!0}),u.worker.addEventListener("message",function(n){var i,e,o=n.data;if("captchaSuccess"===o.action)return function(n,i){var e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name","captcha_verification"),e.setAttribute("value",JSON.stringify(i)),n.appendChild(e),r.events&&t(u.form,"WHC::Verification",{form:u.form,verification:i})}(u.form,o.verification),e=(i=u.button).dataset.finished,i.classList.add("done"),i.removeAttribute("disabled"),i.setAttribute("value",e),void function(t){t.terminate();var n=window.whcWorkers.indexOf(t);window.whcWorkers.splice(n,1)}(u.worker);"message"!==o.action||function(n,i){var e=i.match(/\d{2,3}/);null!==e&&(n.setAttribute("data-progress",e+"%"),r.events&&t(u.form,"WHC::Progress",{progress:e+"%",complete:"100"===e[0]}))}(u.button,o.message)},!1),r.events&&t(u.form,"WHC::Initialize",{form:u.form,ID:u.ID,button:u.button,difficulty:u.difficulty})};e.forEach(function(t,n){return new o(t,n)})}()});
